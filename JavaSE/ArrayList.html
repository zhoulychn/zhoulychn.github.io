<!DOCTYPE html>
<html class="theme theme-white">
<head>
<meta charset="utf-8">
<title>ArrayList</title>
<link href="https://www.zybuluo.com/static/assets/template-theme-white.css" rel="stylesheet" media="screen">
<style type="text/css">

#wmd-preview h1  {
    color: #0077bb; /* 将标题改为蓝色 */
}</style>
</head>
<body class="theme theme-white">
<div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="u0d2" id="arraylist">ArrayList</h1><p data-anchor-id="dluh"><code>集合</code></p><p data-anchor-id="6edc"><a href="http://blog.zhoulychn.com/JavaSE/center.html" target="_blank">点击返回导航页</a></p><hr><p data-anchor-id="hvlc"><div class="toc"><div class="toc">
<ul>
<li><a href="#arraylist">ArrayList</a><ul>
<li><a href="#基础结构">基础结构</a></li>
<li><a href="#1-get">(1) get</a></li>
<li><a href="#2-indexof">(2) indexOf</a></li>
<li><a href="#3-set">(3) set</a></li>
<li><a href="#4-add">(4) add</a></li>
<li><a href="#5-addall">(5) addAll</a></li>
<li><a href="#6-grow">(6) grow</a></li>
<li><a href="#7-remove">(7) remove</a></li>
</ul>
</li>
</ul>
</div>
</div>
</p><hr><div class="md-section-divider"></div><h2 data-anchor-id="ur2n" id="基础结构">基础结构</h2><p data-anchor-id="ehx8"><strong>存储结构</strong>： <br>
<img src="http://static.zybuluo.com/zy380104192/jfkn39eo6iphnw6t1jpw0bej/u=1504423618,2487044337&amp;fm=27&amp;gp=0.jpg" alt="u=1504423618,2487044337&amp;fm=27&amp;gp=0.jpg-14kB" title=""></p><p data-anchor-id="dhub"><strong>继承结构</strong>： <br>
<img src="http://static.zybuluo.com/zy380104192/4bqq6ye46obsz4fbmjei7psq/v2-658a256e49b7f3204c9d968a897abfa1_hd.jpg" alt="v2-658a256e49b7f3204c9d968a897abfa1_hd.jpg-16.6kB" title=""></p><p data-anchor-id="17ta">ArrayList实现List接口,RandomAccess(表示提供随机访问),Cloneable,Serializable。</p><ol data-anchor-id="4pz8">
<li>元素按照插入顺序排序。</li>
<li>允许放入null。</li>
<li>底层通过Object数组实现。</li>
<li>容器有容量capacity属性，容量不足时容器会扩容。</li>
</ol><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="kzy3"><ol class="linenums"><li class="L0"><code class="language-java"><span class="com">//主要属性如下</span></code></li><li class="L1"><code class="language-java"></code></li><li class="L2"><code class="language-java"><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">final</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> DEFAULT_CAPACITY </span><span class="pun">=</span><span class="pln"> </span><span class="lit">10</span><span class="pun">;</span><span class="pln"> </span><span class="com">//默认容量</span></code></li><li class="L3"><code class="language-java"></code></li><li class="L4"><code class="language-java"><span class="kwd">transient</span><span class="pln"> </span><span class="typ">Object</span><span class="pun">[]</span><span class="pln"> elementData</span><span class="pun">;</span><span class="pln">  </span><span class="com">//保存元素的数组</span></code></li><li class="L5"><code class="language-java"></code></li><li class="L6"><code class="language-java"><span class="kwd">private</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> size</span><span class="pun">;</span><span class="pln">  </span><span class="com">//元素个数</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="zn9l" id="1-get">(1) get</h2><p data-anchor-id="tame">调用elementData方法，通过随机索引获取元素，泛型强转后返回。</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="g13j"><ol class="linenums"><li class="L0"><code class="language-java"><span class="kwd">public</span><span class="pln"> E get</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> index</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code class="language-java"><span class="pln">    rangeCheck</span><span class="pun">(</span><span class="pln">index</span><span class="pun">);</span><span class="pln">  </span><span class="com">//索引越界则抛出异常</span></code></li><li class="L2"><code class="language-java"></code></li><li class="L3"><code class="language-java"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> elementData</span><span class="pun">(</span><span class="pln">index</span><span class="pun">);</span></code></li><li class="L4"><code class="language-java"><span class="pun">}</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="1wjx" id="2-indexof">(2) indexOf</h2><p data-anchor-id="jqmp">遍历元素数组查找指定元素对象，返回指定索引位置，如果查找失败，返回-1。</p><p data-anchor-id="7m8g">镜像方法:lastIndexOf，改为自上而下遍历即可。</p><p data-anchor-id="rgte">相关方法:contains，调用查找索引方法，判断返回值是不是-1即可。</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="t1jd"><ol class="linenums"><li class="L0"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> indexOf</span><span class="pun">(</span><span class="typ">Object</span><span class="pln"> o</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code class="language-java"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">o </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L2"><code class="language-java"><span class="pln">        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> size</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span></code></li><li class="L3"><code class="language-java"><span class="pln">            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">elementData</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]==</span><span class="kwd">null</span><span class="pun">)</span><span class="pln">  </span></code></li><li class="L4"><code class="language-java"><span class="pln">                </span><span class="kwd">return</span><span class="pln"> i</span><span class="pun">;</span></code></li><li class="L5"><code class="language-java"><span class="pln">    </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L6"><code class="language-java"><span class="pln">        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> size</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span></code></li><li class="L7"><code class="language-java"><span class="pln">            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">o</span><span class="pun">.</span><span class="pln">equals</span><span class="pun">(</span><span class="pln">elementData</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]))</span><span class="pln">  </span><span class="com">//此处是equals，确保是属性相同的对象</span></code></li><li class="L8"><code class="language-java"><span class="pln">                </span><span class="kwd">return</span><span class="pln"> i</span><span class="pun">;</span></code></li><li class="L9"><code class="language-java"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L0"><code class="language-java"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span></code></li><li class="L1"><code class="language-java"><span class="pun">}</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="28wd" id="3-set">(3) set</h2><p data-anchor-id="xrxl">通过索引找到元素，直接替换，然后返回旧值。</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="u0xh"><ol class="linenums"><li class="L0"><code class="language-java"><span class="kwd">public</span><span class="pln"> E set</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> index</span><span class="pun">,</span><span class="pln"> E element</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code class="language-java"><span class="pln">    rangeCheck</span><span class="pun">(</span><span class="pln">index</span><span class="pun">);</span></code></li><li class="L2"><code class="language-java"></code></li><li class="L3"><code class="language-java"><span class="pln">    E oldValue </span><span class="pun">=</span><span class="pln"> elementData</span><span class="pun">(</span><span class="pln">index</span><span class="pun">);</span></code></li><li class="L4"><code class="language-java"><span class="pln">    elementData</span><span class="pun">[</span><span class="pln">index</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> element</span><span class="pun">;</span></code></li><li class="L5"><code class="language-java"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> oldValue</span><span class="pun">;</span></code></li><li class="L6"><code class="language-java"><span class="pun">}</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="m83f" id="4-add">(4) add</h2><p data-anchor-id="ktqc">判断空间是否够用，不够用直接扩容。</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="5vrt"><ol class="linenums"><li class="L0"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">boolean</span><span class="pln"> add</span><span class="pun">(</span><span class="pln">E e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code class="language-java"><span class="pln">    ensureCapacityInternal</span><span class="pun">(</span><span class="pln">size </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">  </span><span class="com">// Increments modCount!!</span></code></li><li class="L2"><code class="language-java"><span class="pln">    elementData</span><span class="pun">[</span><span class="pln">size</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">;</span></code></li><li class="L3"><code class="language-java"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span></code></li><li class="L4"><code class="language-java"><span class="pun">}</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="vovx" id="5-addall">(5) addAll</h2><p data-anchor-id="dziy">跟add()方法类似，在插入之前也需要进行空间检查，如果需要则自动扩容；如果从指定位置插入，也会存在移动元素的情况。</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="8fsx"><ol class="linenums"><li class="L0"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">boolean</span><span class="pln"> addAll</span><span class="pun">(</span><span class="typ">Collection</span><span class="pun">&lt;?</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> E</span><span class="pun">&gt;</span><span class="pln"> c</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code class="language-java"><span class="pln">    </span><span class="typ">Object</span><span class="pun">[]</span><span class="pln"> a </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">.</span><span class="pln">toArray</span><span class="pun">();</span></code></li><li class="L2"><code class="language-java"><span class="pln">    </span><span class="kwd">int</span><span class="pln"> numNew </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span></code></li><li class="L3"><code class="language-java"><span class="pln">    ensureCapacityInternal</span><span class="pun">(</span><span class="pln">size </span><span class="pun">+</span><span class="pln"> numNew</span><span class="pun">);</span><span class="pln">  </span><span class="com">// Increments modCount</span></code></li><li class="L4"><code class="language-java"><span class="pln">    </span><span class="typ">System</span><span class="pun">.</span><span class="pln">arraycopy</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> elementData</span><span class="pun">,</span><span class="pln"> size</span><span class="pun">,</span><span class="pln"> numNew</span><span class="pun">);</span><span class="pln">  </span><span class="com">//复制数组</span></code></li><li class="L5"><code class="language-java"><span class="pln">    size </span><span class="pun">+=</span><span class="pln"> numNew</span><span class="pun">;</span><span class="pln">  </span><span class="com">//重新设置size</span></code></li><li class="L6"><code class="language-java"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> numNew </span><span class="pun">!=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span></code></li><li class="L7"><code class="language-java"><span class="pun">}</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="vhyt" id="6-grow">(6) grow</h2><p data-anchor-id="wddk">如上所有添加操作都会调用ensureCapacityInternal方法，处理容量变化，最后调用grow有具体策略。</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="8us9"><ol class="linenums"><li class="L0"><code class="language-java"><span class="com">//扩容策略</span></code></li><li class="L1"><code class="language-java"><span class="kwd">private</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> grow</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> minCapacity</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L2"><code class="language-java"><span class="pln">    </span><span class="com">// overflow-conscious code</span></code></li><li class="L3"><code class="language-java"><span class="pln">    </span><span class="kwd">int</span><span class="pln"> oldCapacity </span><span class="pun">=</span><span class="pln"> elementData</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span></code></li><li class="L4"><code class="language-java"></code></li><li class="L5"><code class="language-java"><span class="pln">    </span><span class="com">//扩容1.5倍</span></code></li><li class="L6"><code class="language-java"><span class="pln">    </span><span class="kwd">int</span><span class="pln"> newCapacity </span><span class="pun">=</span><span class="pln"> oldCapacity </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">oldCapacity </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span></code></li><li class="L7"><code class="language-java"></code></li><li class="L8"><code class="language-java"><span class="pln">    </span><span class="com">//容量还是不足，直接等于新容量</span></code></li><li class="L9"><code class="language-java"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">newCapacity </span><span class="pun">-</span><span class="pln"> minCapacity </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span></code></li><li class="L0"><code class="language-java"><span class="pln">        newCapacity </span><span class="pun">=</span><span class="pln"> minCapacity</span><span class="pun">;</span></code></li><li class="L1"><code class="language-java"></code></li><li class="L2"><code class="language-java"><span class="pln">    </span><span class="com">//最大容量</span></code></li><li class="L3"><code class="language-java"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">newCapacity </span><span class="pun">-</span><span class="pln"> MAX_ARRAY_SIZE </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span></code></li><li class="L4"><code class="language-java"><span class="pln">        newCapacity </span><span class="pun">=</span><span class="pln"> hugeCapacity</span><span class="pun">(</span><span class="pln">minCapacity</span><span class="pun">);</span></code></li><li class="L5"><code class="language-java"><span class="pln">    </span><span class="com">// minCapacity is usually close to size, so this is a win:</span></code></li><li class="L6"><code class="language-java"></code></li><li class="L7"><code class="language-java"><span class="pln">    </span><span class="com">//复制到新扩容的数组</span></code></li><li class="L8"><code class="language-java"><span class="pln">    elementData </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Arrays</span><span class="pun">.</span><span class="pln">copyOf</span><span class="pun">(</span><span class="pln">elementData</span><span class="pun">,</span><span class="pln"> newCapacity</span><span class="pun">);</span></code></li><li class="L9"><code class="language-java"><span class="pun">}</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="phne" id="7-remove">(7) remove</h2><p data-anchor-id="t8jc">remove()方法也有两个版本，一个是删除指定位置的元素。删除操作需要将删除点之后的元素向前移动一个位置。需要注意的是为了让GC清除元素，将最后一个位置元素置为null。</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="jkg7"><ol class="linenums"><li class="L0"><code class="language-java"><span class="kwd">public</span><span class="pln"> E remove</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> index</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code class="language-java"><span class="pln">    rangeCheck</span><span class="pun">(</span><span class="pln">index</span><span class="pun">);</span></code></li><li class="L2"><code class="language-java"></code></li><li class="L3"><code class="language-java"><span class="pln">    modCount</span><span class="pun">++;</span></code></li><li class="L4"><code class="language-java"><span class="pln">    E oldValue </span><span class="pun">=</span><span class="pln"> elementData</span><span class="pun">(</span><span class="pln">index</span><span class="pun">);</span><span class="pln">  </span><span class="com">//暂存被删除的元素</span></code></li><li class="L5"><code class="language-java"></code></li><li class="L6"><code class="language-java"><span class="pln">    </span><span class="kwd">int</span><span class="pln"> numMoved </span><span class="pun">=</span><span class="pln"> size </span><span class="pun">-</span><span class="pln"> index </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span></code></li><li class="L7"><code class="language-java"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">numMoved </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span></code></li><li class="L8"><code class="language-java"><span class="pln">        </span><span class="typ">System</span><span class="pun">.</span><span class="pln">arraycopy</span><span class="pun">(</span><span class="pln">elementData</span><span class="pun">,</span><span class="pln"> index</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> elementData</span><span class="pun">,</span><span class="pln"> index</span><span class="pun">,</span></code></li><li class="L9"><code class="language-java"><span class="pln">                         numMoved</span><span class="pun">);</span><span class="pln">  </span><span class="com">//通过数组复制，将后续元素前移</span></code></li><li class="L0"><code class="language-java"><span class="pln">    elementData</span><span class="pun">[--</span><span class="pln">size</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln"> </span><span class="com">// clear to let GC do its work</span></code></li><li class="L1"><code class="language-java"></code></li><li class="L2"><code class="language-java"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> oldValue</span><span class="pun">;</span></code></li><li class="L3"><code class="language-java"><span class="pun">}</span></code></li></ol></pre><p data-anchor-id="7mze">另一个是remove(Object o)删除第一个满足o.equals(elementData[index])的元素。</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ss26"><ol class="linenums"><li class="L0"><code class="language-java"><span class="com">//和查找索引方法类似，只是额外调用了fastRemove方法删除元素</span></code></li><li class="L1"><code class="language-java"></code></li><li class="L2"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">boolean</span><span class="pln"> remove</span><span class="pun">(</span><span class="typ">Object</span><span class="pln"> o</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L3"><code class="language-java"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">o </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code class="language-java"><span class="pln">        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> index </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> index </span><span class="pun">&lt;</span><span class="pln"> size</span><span class="pun">;</span><span class="pln"> index</span><span class="pun">++)</span></code></li><li class="L5"><code class="language-java"><span class="pln">            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">elementData</span><span class="pun">[</span><span class="pln">index</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L6"><code class="language-java"><span class="pln">                fastRemove</span><span class="pun">(</span><span class="pln">index</span><span class="pun">);</span></code></li><li class="L7"><code class="language-java"><span class="pln">                </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span></code></li><li class="L8"><code class="language-java"><span class="pln">            </span><span class="pun">}</span></code></li><li class="L9"><code class="language-java"><span class="pln">    </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L0"><code class="language-java"><span class="pln">        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> index </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> index </span><span class="pun">&lt;</span><span class="pln"> size</span><span class="pun">;</span><span class="pln"> index</span><span class="pun">++)</span></code></li><li class="L1"><code class="language-java"><span class="pln">            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">o</span><span class="pun">.</span><span class="pln">equals</span><span class="pun">(</span><span class="pln">elementData</span><span class="pun">[</span><span class="pln">index</span><span class="pun">]))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">  </span><span class="com">//使用equals比较元素</span></code></li><li class="L2"><code class="language-java"><span class="pln">                fastRemove</span><span class="pun">(</span><span class="pln">index</span><span class="pun">);</span></code></li><li class="L3"><code class="language-java"><span class="pln">                </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span></code></li><li class="L4"><code class="language-java"><span class="pln">            </span><span class="pun">}</span></code></li><li class="L5"><code class="language-java"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L6"><code class="language-java"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span></code></li><li class="L7"><code class="language-java"><span class="pun">}</span></code></li><li class="L8"><code class="language-java"></code></li><li class="L9"><code class="language-java"><span class="com">//根据索引删除，与上述方法类似，只是不用检查索引</span></code></li><li class="L0"><code class="language-java"><span class="kwd">private</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> fastRemove</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> index</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code class="language-java"><span class="pln">    modCount</span><span class="pun">++;</span></code></li><li class="L2"><code class="language-java"><span class="pln">    </span><span class="kwd">int</span><span class="pln"> numMoved </span><span class="pun">=</span><span class="pln"> size </span><span class="pun">-</span><span class="pln"> index </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span></code></li><li class="L3"><code class="language-java"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">numMoved </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span></code></li><li class="L4"><code class="language-java"><span class="pln">        </span><span class="typ">System</span><span class="pun">.</span><span class="pln">arraycopy</span><span class="pun">(</span><span class="pln">elementData</span><span class="pun">,</span><span class="pln"> index</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> elementData</span><span class="pun">,</span><span class="pln"> index</span><span class="pun">,</span></code></li><li class="L5"><code class="language-java"><span class="pln">                         numMoved</span><span class="pun">);</span><span class="pln">  </span><span class="com">//通过数组复制，将后续元素前移</span></code></li><li class="L6"><code class="language-java"><span class="pln">    elementData</span><span class="pun">[--</span><span class="pln">size</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln"> </span><span class="com">// clear to let GC do its work</span></code></li><li class="L7"><code class="language-java"><span class="pun">}</span></code></li></ol></pre></div>
</body>
</html>