<!DOCTYPE html>
<html class="theme theme-white">
<head>
<meta charset="utf-8">
<title>数列全排列</title>
<link href="https://www.zybuluo.com/static/assets/template-theme-white.css" rel="stylesheet" media="screen">
<style type="text/css">

#wmd-preview h1  {
    color: #0077bb; /* 将标题改为蓝色 */
}</style>
</head>
<body class="theme theme-white">
<div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="ew48" id="数列全排列">数列全排列</h1><p data-anchor-id="zcx7"><code>数据结构与算法</code></p><p data-anchor-id="j1la"><a href="http://zhoulychn.github.io/algorithm/center.html" target="_blank">点击返回导航页</a></p><hr><div class="md-section-divider"></div><h2 data-anchor-id="3a4y" id="问题描述">问题描述</h2><p data-anchor-id="vpp4">给定一个数字列表，返回其所有可能的排列。你可以假设没有重复数字。</p><div class="md-section-divider"></div><h2 data-anchor-id="7m56" id="插空法">插空法</h2><p data-anchor-id="khsi">根据排列组合的知识，每次并入一个数字，将它插入到之前所有已得到数列的中间空位，就可以得到所有的数列组合。</p><p data-anchor-id="7uvi">模拟[1,2,3]获取全排列的过程：</p><p data-anchor-id="t0cg">当并入第一个数1时，只有数列<a href="http://static.zybuluo.com/zy380104192/tqj2vu4693p48wakcvcbsti5/image_1c87aa54j7gs1am513as5431i9d9.png" target="_blank">1</a>。</p><p data-anchor-id="zjnn">当并入2时，对之前单个数的数列有两个位置可以插入，得到[1,2]和[2,1]。</p><p data-anchor-id="tl0e">当并入3时，对之前两个数列分别插入，两个数的数列则会有三个位置插入，总共有6种排列。</p><p data-anchor-id="jo7s">根据以上的思想，实现代码也不难了，但是注意数据结构的选型，频繁在中间插入，如果使用ArrayList则会移动数据，所以应该选用LinkedList。</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="wmyo"><ol class="linenums"><li class="L0"><code class="language-java"><span class="kwd">private</span><span class="pln"> </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Integer</span><span class="pun">&gt;&gt;</span><span class="pln"> permute</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">[]</span><span class="pln"> nums</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code class="language-java"></code></li><li class="L2"><code class="language-java"><span class="pln">    </span><span class="com">//结果</span></code></li><li class="L3"><code class="language-java"><span class="pln">    </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Integer</span><span class="pun">&gt;&gt;</span><span class="pln"> result </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ArrayList</span><span class="pun">&lt;&gt;();</span></code></li><li class="L4"><code class="language-java"></code></li><li class="L5"><code class="language-java"><span class="pln">    </span><span class="com">//空处理</span></code></li><li class="L6"><code class="language-java"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">nums</span><span class="pun">.</span><span class="pln">length </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L7"><code class="language-java"><span class="pln">        result</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ArrayList</span><span class="pun">&lt;&gt;());</span></code></li><li class="L8"><code class="language-java"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> result</span><span class="pun">;</span></code></li><li class="L9"><code class="language-java"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L0"><code class="language-java"></code></li><li class="L1"><code class="language-java"><span class="pln">    </span><span class="com">//遍历每一个排列数字。</span></code></li><li class="L2"><code class="language-java"><span class="pln">    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">:</span><span class="pln"> nums</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L3"><code class="language-java"></code></li><li class="L4"><code class="language-java"><span class="pln">        </span><span class="com">//如果结果没有排列记录，第一次做特殊处理。</span></code></li><li class="L5"><code class="language-java"><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">result</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L6"><code class="language-java"><span class="pln">            result</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">LinkedList</span><span class="pun">&lt;</span><span class="typ">Integer</span><span class="pun">&gt;());</span></code></li><li class="L7"><code class="language-java"><span class="pln">            result</span><span class="pun">.</span><span class="pln">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">).</span><span class="pln">add</span><span class="pun">(</span><span class="pln">nums</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]);</span></code></li><li class="L8"><code class="language-java"><span class="pln">            </span><span class="kwd">continue</span><span class="pun">;</span></code></li><li class="L9"><code class="language-java"><span class="pln">        </span><span class="pun">}</span></code></li><li class="L0"><code class="language-java"></code></li><li class="L1"><code class="language-java"><span class="pln">        </span><span class="com">//保存这一次获得的所有记录。</span></code></li><li class="L2"><code class="language-java"><span class="pln">        </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Integer</span><span class="pun">&gt;&gt;</span><span class="pln"> array </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ArrayList</span><span class="pun">&lt;&gt;();</span></code></li><li class="L3"><code class="language-java"></code></li><li class="L4"><code class="language-java"><span class="pln">        </span><span class="com">//遍历之前的每一个组合，准备其插入数据。</span></code></li><li class="L5"><code class="language-java"><span class="pln">        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Integer</span><span class="pun">&gt;</span><span class="pln"> each </span><span class="pun">:</span><span class="pln"> result</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L6"><code class="language-java"></code></li><li class="L7"><code class="language-java"><span class="pln">            </span><span class="com">//遍历数列的每个空位，在中间插入数据。</span></code></li><li class="L8"><code class="language-java"></code></li><li class="L9"><code class="language-java"><span class="pln">            </span><span class="com">//此处可能会好奇，当索引为size时，不会越界吗？ArrayList会，但是LinkedList不会。</span></code></li><li class="L0"><code class="language-java"><span class="pln">            </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;=</span><span class="pln"> each</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code class="language-java"></code></li><li class="L2"><code class="language-java"><span class="pln">                </span><span class="com">//根据本次操作的记录创建新数列。</span></code></li><li class="L3"><code class="language-java"><span class="pln">                </span><span class="typ">LinkedList</span><span class="pun">&lt;</span><span class="typ">Integer</span><span class="pun">&gt;</span><span class="pln"> list </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">LinkedList</span><span class="pun">&lt;&gt;(</span><span class="pln">each</span><span class="pun">);</span></code></li><li class="L4"><code class="language-java"></code></li><li class="L5"><code class="language-java"><span class="pln">                </span><span class="com">//新数列中插入</span></code></li><li class="L6"><code class="language-java"><span class="pln">                list</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="pln">j</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">);</span></code></li><li class="L7"><code class="language-java"><span class="pln">                array</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="pln">list</span><span class="pun">);</span></code></li><li class="L8"><code class="language-java"><span class="pln">            </span><span class="pun">}</span></code></li><li class="L9"><code class="language-java"><span class="pln">        </span><span class="pun">}</span></code></li><li class="L0"><code class="language-java"></code></li><li class="L1"><code class="language-java"><span class="pln">        </span><span class="com">//先清空上一次的数列记录，然后重置为本次的数列记录</span></code></li><li class="L2"><code class="language-java"><span class="pln">        result</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span></code></li><li class="L3"><code class="language-java"><span class="pln">        result </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">;</span></code></li><li class="L4"><code class="language-java"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L5"><code class="language-java"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> result</span><span class="pun">;</span></code></li><li class="L6"><code class="language-java"><span class="pun">}</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="jmvc" id="回溯">回溯</h2><p data-anchor-id="as8w">如图所示，每次取出一个数，其后选择就会少一个，进入下一层再次选择一个数，不断循环，最后只剩一个数，就成了一个序列记录。循环中按顺序取每个数，全部统计起来就是所有排列。</p><p data-anchor-id="zxre"><img src="http://static.zybuluo.com/zy380104192/tqj2vu4693p48wakcvcbsti5/image_1c87aa54j7gs1am513as5431i9d9.png" alt="image_1c87aa54j7gs1am513as5431i9d9.png-81.2kB"></p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="h1b7"><ol class="linenums"><li class="L0"><code class="language-java"></code></li><li class="L1"><code class="language-java"><span class="com">//结果</span></code></li><li class="L2"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Integer</span><span class="pun">&gt;&gt;</span><span class="pln"> result </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ArrayList</span><span class="pun">&lt;&gt;();</span></code></li><li class="L3"><code class="language-java"></code></li><li class="L4"><code class="language-java"><span class="com">//递归过程中使用的数列</span></code></li><li class="L5"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="typ">ArrayList</span><span class="pun">&lt;</span><span class="typ">Integer</span><span class="pun">&gt;</span><span class="pln"> currArray </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ArrayList</span><span class="pun">&lt;&gt;();</span></code></li><li class="L6"><code class="language-java"></code></li><li class="L7"><code class="language-java"><span class="com">//将所有的数转成list，然后作为传入参数</span></code></li><li class="L8"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Integer</span><span class="pun">&gt;&gt;</span><span class="pln"> permute</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">[]</span><span class="pln"> nums</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L9"><code class="language-java"></code></li><li class="L0"><code class="language-java"><span class="pln">    </span><span class="com">//为空判断</span></code></li><li class="L1"><code class="language-java"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">nums </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">null</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> nums</span><span class="pun">.</span><span class="pln">length </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L2"><code class="language-java"><span class="pln">        result</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ArrayList</span><span class="pun">&lt;</span><span class="typ">Integer</span><span class="pun">&gt;());</span></code></li><li class="L3"><code class="language-java"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> result</span><span class="pun">;</span></code></li><li class="L4"><code class="language-java"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L5"><code class="language-java"><span class="pln">    </span><span class="typ">ArrayList</span><span class="pun">&lt;</span><span class="typ">Integer</span><span class="pun">&gt;</span><span class="pln"> numsArray </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ArrayList</span><span class="pun">&lt;&gt;();</span></code></li><li class="L6"><code class="language-java"><span class="pln">    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">:</span><span class="pln"> nums</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L7"><code class="language-java"><span class="pln">        numsArray</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span></code></li><li class="L8"><code class="language-java"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L9"><code class="language-java"><span class="pln">    </span><span class="typ">Helper</span><span class="pun">(</span><span class="pln">numsArray</span><span class="pun">);</span></code></li><li class="L0"><code class="language-java"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> result</span><span class="pun">;</span></code></li><li class="L1"><code class="language-java"><span class="pun">}</span></code></li><li class="L2"><code class="language-java"></code></li><li class="L3"><code class="language-java"><span class="kwd">private</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Helper</span><span class="pun">(</span><span class="typ">ArrayList</span><span class="pun">&lt;</span><span class="typ">Integer</span><span class="pun">&gt;</span><span class="pln"> numsArray</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code class="language-java"></code></li><li class="L5"><code class="language-java"><span class="pln">    </span><span class="com">//数列为空，说明一次排列已经完成</span></code></li><li class="L6"><code class="language-java"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">numsArray</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L7"><code class="language-java"><span class="pln">        result</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ArrayList</span><span class="pun">&lt;</span><span class="typ">Integer</span><span class="pun">&gt;(</span><span class="pln">currArray</span><span class="pun">));</span></code></li><li class="L8"><code class="language-java"></code></li><li class="L9"><code class="language-java"><span class="pln">        </span><span class="com">//移除最后一个元素</span></code></li><li class="L0"><code class="language-java"><span class="pln">        currArray</span><span class="pun">.</span><span class="pln">remove</span><span class="pun">(</span><span class="pln">currArray</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span></code></li><li class="L1"><code class="language-java"><span class="pln">        </span><span class="kwd">return</span><span class="pun">;</span></code></li><li class="L2"><code class="language-java"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L3"><code class="language-java"><span class="pln">    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> numsArray</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code class="language-java"></code></li><li class="L5"><code class="language-java"><span class="pln">        </span><span class="com">//当前数字并入序列</span></code></li><li class="L6"><code class="language-java"><span class="pln">        currArray</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="pln">numsArray</span><span class="pun">.</span><span class="pln">get</span><span class="pun">(</span><span class="pln">i</span><span class="pun">));</span></code></li><li class="L7"><code class="language-java"></code></li><li class="L8"><code class="language-java"><span class="pln">        </span><span class="com">//递归调用，参数不含当前数字</span></code></li><li class="L9"><code class="language-java"><span class="pln">        </span><span class="typ">ArrayList</span><span class="pun">&lt;</span><span class="typ">Integer</span><span class="pun">&gt;</span><span class="pln"> numsLeft </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ArrayList</span><span class="pun">&lt;</span><span class="typ">Integer</span><span class="pun">&gt;(</span><span class="pln">numsArray</span><span class="pun">);</span></code></li><li class="L0"><code class="language-java"><span class="pln">        numsLeft</span><span class="pun">.</span><span class="pln">remove</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span></code></li><li class="L1"><code class="language-java"><span class="pln">        </span><span class="typ">Helper</span><span class="pun">(</span><span class="pln">numsLeft</span><span class="pun">);</span></code></li><li class="L2"><code class="language-java"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L3"><code class="language-java"></code></li><li class="L4"><code class="language-java"><span class="pln">    </span><span class="com">//移除最后一个元素</span></code></li><li class="L5"><code class="language-java"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">currArray</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L6"><code class="language-java"><span class="pln">        currArray</span><span class="pun">.</span><span class="pln">remove</span><span class="pun">(</span><span class="pln">currArray</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span></code></li><li class="L7"><code class="language-java"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L8"><code class="language-java"><span class="pln">    </span><span class="kwd">return</span><span class="pun">;</span></code></li><li class="L9"><code class="language-java"><span class="pun">}</span></code></li></ol></pre></div>
</body>
</html>