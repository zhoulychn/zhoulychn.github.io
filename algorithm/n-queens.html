<!DOCTYPE html>
<html class="theme theme-white">
<head>
<meta charset="utf-8">
<title>N皇后问题</title>
<link href="https://www.zybuluo.com/static/assets/template-theme-white.css" rel="stylesheet" media="screen">
<style type="text/css">

#wmd-preview h1  {
    color: #0077bb; /* 将标题改为蓝色 */
}</style>
</head>
<body class="theme theme-white">
<div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="qk6h" id="n皇后问题">N皇后问题</h1><p data-anchor-id="ryzg"><code>数据结构与算法</code></p><p data-anchor-id="v20p"><a href="http://zhoulychn.github.io/algorithm/center.html" target="_blank">点击返回导航页</a></p><hr><div class="md-section-divider"></div><h2 data-anchor-id="5rx6" id="问题描述">问题描述</h2><p data-anchor-id="qkaq"><img src="http://static.zybuluo.com/zy380104192/j8nb4dmqgqc1o99l1q7u3zx3/image_1c8ujnaf41u4l19k1e5r1ihl1mg5p.png" alt="image_1c8ujnaf41u4l19k1e5r1ihl1mg5p.png-56.9kB"></p><p data-anchor-id="i01h">n皇后问题是将n个皇后放置在n*n的棋盘上，皇后彼此之间不能相互攻击，横竖不能 。</p><p data-anchor-id="kvqd">给定一个整数n，返回n皇后问题的解决方案总个数。</p><div class="md-section-divider"></div><h2 data-anchor-id="0z81" id="算法思路">算法思路</h2><p data-anchor-id="8jpu">由于横竖无法攻击，所以n个分布在每行每列，所以从第一行开始放置，每次放置一个皇后，然后利用回溯的思想，递归进入函数，放置下一层的皇后。</p><p data-anchor-id="fc33">放置时不被攻击判断:|row1-row2| == |column1-column2|（行列差的绝对值相等）。</p><div class="md-section-divider"></div><h2 data-anchor-id="v82f" id="代码实现">代码实现</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="3gfh"><ol class="linenums"><li class="L0"><code class="language-java"><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> sum </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span></code></li><li class="L1"><code class="language-java"></code></li><li class="L2"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> solveNQueens</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L3"><code class="language-java"></code></li><li class="L4"><code class="language-java"><span class="pln">    </span><span class="com">//track记录位置，list中每个索引代表层数，索引处的值为所在位置，下标从1开始</span></code></li><li class="L5"><code class="language-java"><span class="pln">    </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Integer</span><span class="pun">&gt;</span><span class="pln"> track </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ArrayList</span><span class="pun">&lt;&gt;(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span></code></li><li class="L6"><code class="language-java"></code></li><li class="L7"><code class="language-java"><span class="pln">    track</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span></code></li><li class="L8"><code class="language-java"><span class="pln">    backTrack</span><span class="pun">(</span><span class="pln">track</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">);</span></code></li><li class="L9"><code class="language-java"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> sum</span><span class="pun">;</span></code></li><li class="L0"><code class="language-java"><span class="pun">}</span></code></li><li class="L1"><code class="language-java"></code></li><li class="L2"><code class="language-java"><span class="com">//回溯方法</span></code></li><li class="L3"><code class="language-java"><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> backTrack</span><span class="pun">(</span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Integer</span><span class="pun">&gt;</span><span class="pln"> track</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code class="language-java"></code></li><li class="L5"><code class="language-java"><span class="pln">    </span><span class="com">//track的size表示有多少层已放置皇后</span></code></li><li class="L6"><code class="language-java"><span class="pln">    </span><span class="kwd">int</span><span class="pln"> size </span><span class="pun">=</span><span class="pln"> track</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span></code></li><li class="L7"><code class="language-java"></code></li><li class="L8"><code class="language-java"><span class="pln">    </span><span class="com">//当track的size为n+1时表示放满，因为此前说过包含不使用的0元素。</span></code></li><li class="L9"><code class="language-java"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">size </span><span class="pun">==</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L0"><code class="language-java"></code></li><li class="L1"><code class="language-java"><span class="pln">        </span><span class="com">//完成一种放置后，记录加一，移除最后一个元素，等待下一个可用皇后放置。</span></code></li><li class="L2"><code class="language-java"><span class="pln">        sum</span><span class="pun">++;</span></code></li><li class="L3"><code class="language-java"><span class="pln">        track</span><span class="pun">.</span><span class="pln">remove</span><span class="pun">(</span><span class="pln">size </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span></code></li><li class="L4"><code class="language-java"><span class="pln">        </span><span class="kwd">return</span><span class="pun">;</span></code></li><li class="L5"><code class="language-java"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L6"><code class="language-java"></code></li><li class="L7"><code class="language-java"><span class="pln">    </span><span class="com">//每一层均从1开始放置，遇到可用位置则放置，然后递归进入，放置下一层。</span></code></li><li class="L8"><code class="language-java"><span class="pln">    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L9"><code class="language-java"><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">isNotAttack</span><span class="pun">(</span><span class="pln">track</span><span class="pun">,</span><span class="pln"> j</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L0"><code class="language-java"><span class="pln">            track</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="pln">j</span><span class="pun">);</span></code></li><li class="L1"><code class="language-java"><span class="pln">            backTrack</span><span class="pun">(</span><span class="pln">track</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">);</span></code></li><li class="L2"><code class="language-java"><span class="pln">        </span><span class="pun">}</span></code></li><li class="L3"><code class="language-java"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L4"><code class="language-java"><span class="pln">    </span><span class="com">//每一层完成后，移除最后一个皇后。</span></code></li><li class="L5"><code class="language-java"><span class="pln">    track</span><span class="pun">.</span><span class="pln">remove</span><span class="pun">(</span><span class="pln">size </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span></code></li><li class="L6"><code class="language-java"><span class="pun">}</span></code></li><li class="L7"><code class="language-java"></code></li><li class="L8"><code class="language-java"><span class="com">//判断位置是否可用</span></code></li><li class="L9"><code class="language-java"><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">boolean</span><span class="pln"> isNotAttack</span><span class="pun">(</span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Integer</span><span class="pun">&gt;</span><span class="pln"> track</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> index</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L0"><code class="language-java"><span class="pln">    </span><span class="kwd">int</span><span class="pln"> size </span><span class="pun">=</span><span class="pln"> track</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span></code></li><li class="L1"><code class="language-java"></code></li><li class="L2"><code class="language-java"><span class="pln">    </span><span class="com">//第一层的所有位置均可以放置</span></code></li><li class="L3"><code class="language-java"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">size </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span></code></li><li class="L4"><code class="language-java"></code></li><li class="L5"><code class="language-java"><span class="pln">    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> size</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L6"><code class="language-java"><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">index </span><span class="pun">==</span><span class="pln"> track</span><span class="pun">.</span><span class="pln">get</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> size </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">==</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">abs</span><span class="pun">(</span><span class="pln">index </span><span class="pun">-</span><span class="pln"> track</span><span class="pun">.</span><span class="pln">get</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)))</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L7"><code class="language-java"><span class="pln">            </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span></code></li><li class="L8"><code class="language-java"><span class="pln">        </span><span class="pun">}</span></code></li><li class="L9"><code class="language-java"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L0"><code class="language-java"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span></code></li><li class="L1"><code class="language-java"><span class="pun">}</span></code></li></ol></pre></div>
</body>
</html>