<!DOCTYPE html>
<html class="theme theme-white">
<head>
<meta charset="utf-8">
<title>书本折扣问题</title>
<link href="https://www.zybuluo.com/static/assets/template-theme-white.css" rel="stylesheet" media="screen">
<style type="text/css">

#wmd-preview h1  {
    color: #0077bb; /* 将标题改为蓝色 */
}</style>
</head>
<body class="theme theme-white">
<div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="68p5" id="书本折扣问题">书本折扣问题</h1><p data-anchor-id="hrys"><code>数据结构与算法</code></p><p data-anchor-id="76mx"><a href="http://zhoulychn.github.io/algorithm/center.html" target="_blank">点击返回导航页</a></p><hr><div class="md-section-divider"></div><h2 data-anchor-id="h93g" id="问题描述">问题描述</h2><p data-anchor-id="ty6w">上柜的《哈利波特》平装本系列，一共有五卷。假设每一卷单独销售均需8欧元。如果读者一次购买不同的两卷，就可以扣除5%的费用，三卷则更多。假设具体折扣的情况如下：</p><blockquote data-anchor-id="kzzb" class="white-blockquote">
  <p>本数    2       折扣   5% <br>
  本数    3       折扣  10% <br>
  本数    4       折扣  20% <br>
  本数    5       折扣  25% </p>
</blockquote><p data-anchor-id="n8k5">问题：设计出算法，能够计算出读者所购买的一批书的最低价格。</p><div class="md-section-divider"></div><h2 data-anchor-id="6vef" id="算法思路">算法思路</h2><p data-anchor-id="83ii">这类问题很容易想到贪心算法，但是在这个问题中，若有8本书，按4+4比5+3更便宜，贪心算法也就失效了，所以用DP解决问题比较容易。</p><p data-anchor-id="i884">设F(x1,x2,x3,x4,...,xn)，因为书本只要不同就行，是哪一本并不重要，所以F的输入保持降序排列，便于构造子结构。</p><p data-anchor-id="fstw">状态转移方程：</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="8d6q"><ol class="linenums"><li class="L0"><code class="language-java"></code></li><li class="L1"><code class="language-java"><span class="com">//x1-&gt;xn保持降序排列，p代表单价，d[]表示各数量书籍的折扣</span></code></li><li class="L2"><code class="language-java"></code></li><li class="L3"><code class="language-java"><span class="pln">F</span><span class="pun">(</span><span class="pln">x1</span><span class="pun">,</span><span class="pln">x2</span><span class="pun">,</span><span class="pln">x3</span><span class="pun">,</span><span class="pln">x4</span><span class="pun">,...,</span><span class="pln">xn</span><span class="pun">)=</span></code></li><li class="L4"><code class="language-java"></code></li><li class="L5"><code class="language-java"><span class="com">//集合中表示每次抽取1-n本书计算折扣，剩下的问题递归求最优解。</span></code></li><li class="L6"><code class="language-java"><span class="pln">min</span><span class="pun">:{</span></code></li><li class="L7"><code class="language-java"><span class="pln">    p </span><span class="pun">+</span><span class="pln"> F</span><span class="pun">(</span><span class="pln">x1 </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> x2</span><span class="pun">,</span><span class="pln"> x3</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...,</span><span class="pln"> xn</span><span class="pun">),</span><span class="pln"> </span><span class="com">//x1&gt;=1</span></code></li><li class="L8"><code class="language-java"><span class="pln">    </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> d</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p </span><span class="pun">+</span><span class="pln"> F</span><span class="pun">(</span><span class="pln">x1 </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> x2 </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> x3</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...,</span><span class="pln"> xn</span><span class="pun">),</span><span class="pln"> </span><span class="com">//x2&gt;=1</span></code></li><li class="L9"><code class="language-java"><span class="pln">    n </span><span class="pun">*</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p </span><span class="pun">+</span><span class="pln"> F</span><span class="pun">(</span><span class="pln">x1 </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> x2 </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> x3 </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">...</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> xn </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> </span><span class="com">//xn&gt;=1</span></code></li><li class="L0"><code class="language-java"><span class="pun">}</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="nf6z" id="代码实现">代码实现</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="na48"><ol class="linenums"><li class="L0"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> calc</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">[]</span><span class="pln"> quantity</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">double</span><span class="pun">[]</span><span class="pln"> discount</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> price</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code class="language-java"></code></li><li class="L2"><code class="language-java"><span class="pln">    </span><span class="com">//书本数量</span></code></li><li class="L3"><code class="language-java"><span class="pln">    </span><span class="kwd">int</span><span class="pln"> size </span><span class="pun">=</span><span class="pln"> quantity</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span></code></li><li class="L4"><code class="language-java"></code></li><li class="L5"><code class="language-java"><span class="pln">    </span><span class="com">//升序排序之后，倒置成降序</span></code></li><li class="L6"><code class="language-java"><span class="pln">    </span><span class="typ">Arrays</span><span class="pun">.</span><span class="pln">sort</span><span class="pun">(</span><span class="pln">quantity</span><span class="pun">);</span></code></li><li class="L7"><code class="language-java"><span class="pln">    </span><span class="typ">SortUtils</span><span class="pun">.</span><span class="pln">reverse</span><span class="pun">(</span><span class="pln">quantity</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> quantity</span><span class="pun">.</span><span class="pln">length </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span></code></li><li class="L8"><code class="language-java"></code></li><li class="L9"><code class="language-java"><span class="pln">    </span><span class="com">//求解最小值</span></code></li><li class="L0"><code class="language-java"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> helper</span><span class="pun">(</span><span class="pln">quantity</span><span class="pun">,</span><span class="pln"> discount</span><span class="pun">,</span><span class="pln"> price</span><span class="pun">);</span></code></li><li class="L1"><code class="language-java"><span class="pun">}</span></code></li><li class="L2"><code class="language-java"></code></li><li class="L3"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> helper</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">[]</span><span class="pln"> quantity</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">double</span><span class="pun">[]</span><span class="pln"> discount</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> price</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code class="language-java"></code></li><li class="L5"><code class="language-java"><span class="pln">    </span><span class="com">//最大数量为0，则书本购买已经分配完成</span></code></li><li class="L6"><code class="language-java"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">quantity</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L7"><code class="language-java"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span></code></li><li class="L8"><code class="language-java"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L9"><code class="language-java"></code></li><li class="L0"><code class="language-java"><span class="pln">    </span><span class="kwd">double</span><span class="pln"> min </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Double</span><span class="pun">.</span><span class="pln">MAX_VALUE</span><span class="pun">;</span></code></li><li class="L1"><code class="language-java"></code></li><li class="L2"><code class="language-java"><span class="pln">    </span><span class="com">//迭代选取1-n本书</span></code></li><li class="L3"><code class="language-java"><span class="pln">    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> quantity</span><span class="pun">.</span><span class="pln">length </span><span class="pun">&amp;&amp;</span><span class="pln"> quantity</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code class="language-java"></code></li><li class="L5"><code class="language-java"><span class="pln">        </span><span class="com">//每次递归的参数需要修改，所以复制一份数据当作输入参数</span></code></li><li class="L6"><code class="language-java"><span class="pln">        </span><span class="kwd">int</span><span class="pun">[]</span><span class="pln"> list </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Arrays</span><span class="pun">.</span><span class="pln">copyOf</span><span class="pun">(</span><span class="pln">quantity</span><span class="pun">,</span><span class="pln"> quantity</span><span class="pun">.</span><span class="pln">length</span><span class="pun">);</span></code></li><li class="L7"><code class="language-java"></code></li><li class="L8"><code class="language-java"><span class="pln">        </span><span class="com">//根据i，将抽取的书本各-1</span></code></li><li class="L9"><code class="language-java"><span class="pln">        </span><span class="kwd">int</span><span class="pln"> temp </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span></code></li><li class="L0"><code class="language-java"><span class="pln">        </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">temp </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code class="language-java"><span class="pln">            list</span><span class="pun">[</span><span class="pln">temp</span><span class="pun">--]</span><span class="pln"> </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span></code></li><li class="L2"><code class="language-java"><span class="pln">        </span><span class="pun">}</span></code></li><li class="L3"><code class="language-java"></code></li><li class="L4"><code class="language-java"><span class="pln">        </span><span class="com">//降序排列输入数据</span></code></li><li class="L5"><code class="language-java"><span class="pln">        </span><span class="typ">Arrays</span><span class="pun">.</span><span class="pln">sort</span><span class="pun">(</span><span class="pln">list</span><span class="pun">);</span></code></li><li class="L6"><code class="language-java"><span class="pln">        </span><span class="typ">SortUtils</span><span class="pun">.</span><span class="pln">reverse</span><span class="pun">(</span><span class="pln">list</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> quantity</span><span class="pun">.</span><span class="pln">length </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span></code></li><li class="L7"><code class="language-java"></code></li><li class="L8"><code class="language-java"><span class="pln">        </span><span class="com">//计算抽取的书本统计价格，并递归后续书本最优解。</span></code></li><li class="L9"><code class="language-java"><span class="pln">        </span><span class="kwd">double</span><span class="pln"> val </span><span class="pun">=</span><span class="pln"> helper</span><span class="pun">(</span><span class="pln">list</span><span class="pun">,</span><span class="pln"> discount</span><span class="pun">,</span><span class="pln"> price</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> discount</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> price</span><span class="pun">;</span></code></li><li class="L0"><code class="language-java"></code></li><li class="L1"><code class="language-java"><span class="pln">        </span><span class="com">//保留最小值</span></code></li><li class="L2"><code class="language-java"><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">val </span><span class="pun">&lt;</span><span class="pln"> min</span><span class="pun">)</span><span class="pln"> min </span><span class="pun">=</span><span class="pln"> val</span><span class="pun">;</span></code></li><li class="L3"><code class="language-java"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L4"><code class="language-java"><span class="pln">    </span><span class="kwd">return</span><span class="pln"> min</span><span class="pun">;</span></code></li><li class="L5"><code class="language-java"></code></li><li class="L6"><code class="language-java"><span class="pun">}</span></code></li></ol></pre></div>
</body>
</html>